<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.458">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Killian Cimino - Magic The Gathering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Killian Cimino</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../resume.html"> 
<span class="menu-text">Resume</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kcimino"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#start" id="toc-start" class="nav-link active" data-scroll-target="#start">start</a></li>
  <li><a href="#text" id="toc-text" class="nav-link" data-scroll-target="#text">Text</a></li>
  <li><a href="#coocurrance" id="toc-coocurrance" class="nav-link" data-scroll-target="#coocurrance">Coocurrance</a></li>
  <li><a href="#machine-learning" id="toc-machine-learning" class="nav-link" data-scroll-target="#machine-learning">Machine Learning</a></li>
  <li><a href="#saving-data-for-reuse" id="toc-saving-data-for-reuse" class="nav-link" data-scroll-target="#saving-data-for-reuse">Saving Data for reuse</a></li>
  <li><a href="#end" id="toc-end" class="nav-link" data-scroll-target="#end">End</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Magic The Gathering</h1>
  <div class="quarto-categories">
    <div class="quarto-category">notebook</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="start" class="level1"><h1>start</h1>
<div class="cell" data-hash="magicTheGathering_cache/html/initialization_7241c7e34d6675c4c0b7a493ba7483a1">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"startrun"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">fortune</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Scripts"</span>, <span class="st">"starthere.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in value[[3L]](cond): restarting interrupted promise evaluation</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>* The library is already synchronized with the lockfile.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[conflicted] Will prefer base::trunc over any other package.
[conflicted] Will prefer tictoc::size over any other package.
[conflicted] Will prefer base::setdiff over any other package.</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Data"</span>, <span class="st">"Cleaned"</span>, <span class="st">"MTGCards.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">params</span><span class="op">$</span><span class="va">datarefresh</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Data"</span>, <span class="st">"Cleaned"</span>, <span class="st">"MTGCards.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Txtdf</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Data"</span>,<span class="st">"Cleaned"</span>,<span class="st">"MTGCardsText.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ColorlessTxtdf</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Data"</span>,<span class="st">"Cleaned"</span>,<span class="st">"MTGCardsTextColorless.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">keywords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Data"</span>,<span class="st">"Cleaned"</span>,<span class="st">"MTGKeywords.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>                   <span class="co"># from scryfall api</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Scripts"</span>,<span class="st">"MTGclean.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Rows: 41081 Columns: 282
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (11): name, layout, mana_cost, type, rarity, text, flavor, set_name, co...
dbl (261): multiverse_id, converted_mana_cost, power, toughness, red_cost, g...
lgl  (10): names, colors, color_identity, supertypes, subtypes, variations, ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 31689 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): name, combined_general_type, flavor, color, text

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 5066 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): name, combined_general_type, flavor, color, text

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 251 Columns: 1
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): value

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>The data comes from the magicthegathering.io api, and just some basic munging is done to it for analysis</p>
<div class="cell" data-hash="magicTheGathering_cache/html/df overview_f0f3078474b3b3751f977403c77ce072">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">legalities</span>, <span class="op">-</span><span class="va">printings</span>, <span class="op">-</span><span class="va">rulings</span>,<span class="op">-</span><span class="va">variations</span>,<span class="op">-</span><span class="va">text</span>, <span class="op">-</span><span class="va">names</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contents</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
The data frame . has 41,081 observations and 276 variables.

Overall
 pos varname                          type      n_unique n_miss pct_miss
   1 name                             character 12136        0  0%      
   2 multiverse_id                    numeric   40861        0  0%      
   3 layout                           character    14        0  0%      
   4 mana_cost                        character   525        0  0%      
   5 converted_mana_cost              numeric      17        0  0%      
   6 colors                           logical       1    41081  100%    
   7 color_identity                   logical       1    41081  100%    
   8 type                             character  2382        0  0%      
   9 supertypes                       logical       1    41081  100%    
  10 subtypes                         logical       1    41081  100%    
  11 rarity                           character     6        0  0%      
  12 flavor                           character 15724    16689  41%     
  13 power                            numeric      22    17796  43%     
  14 toughness                        numeric      23    17796  43%     
  15 source                           logical       1    41081  100%    
  16 set_name                         character   290        0  0%      
  17 red_cost                         numeric       5        0  0%      
  18 green_cost                       numeric       5        0  0%      
  19 blue_cost                        numeric       5        0  0%      
  20 white_cost                       numeric       5        0  0%      
  21 black_cost                       numeric       5        0  0%      
  22 colorless_cost                   numeric      17        0  0%      
  23 multicolor                       numeric       2        0  0%      
  24 color_red                        numeric       2        0  0%      
  25 color_green                      numeric       2        0  0%      
  26 color_blue                       numeric       2        0  0%      
  27 color_white                      numeric       2        0  0%      
  28 color_black                      numeric       2        0  0%      
  29 color_colorless                  numeric       2        0  0%      
  30 color_identity_red               numeric       2        0  0%      
  31 color_identity_green             numeric       2        0  0%      
  32 color_identity_blue              numeric       2        0  0%      
  33 color_identity_white             numeric       2        0  0%      
  34 color_identity_black             numeric       2        0  0%      
  35 variable_power                   numeric       2        0  0%      
  36 variable_toughness               numeric       2        0  0%      
  37 creature                         numeric       2        0  0%      
  38 land                             numeric       1        0  0%      
  39 artifact                         numeric       2        0  0%      
  40 enchantment                      numeric       2        0  0%      
  41 planeswalker                     numeric       2        0  0%      
  42 battle                           numeric       2        0  0%      
  43 instant                          numeric       2        0  0%      
  44 sorcery                          numeric       2        0  0%      
  45 combined_general_type            character    12        4  0%      
  46 multitype                        numeric       2        0  0%      
  47 mana_cost_q                      character     4        0  0%      
  48 mana_cost_t                      character     3        0  0%      
  49 number_of_same_cards             numeric      59        0  0%      
  50 keyword_First strike             numeric       2        0  0%      
  51 keyword_NA                       numeric       1        0  0%      
  52 keyword_Flying                   numeric       2        0  0%      
  53 keyword_Defender                 numeric       2        0  0%      
  54 keyword_Sacrifice                numeric       2        0  0%      
  55 keyword_Destroy                  numeric       2        0  0%      
  56 keyword_Squad                    numeric       2        0  0%      
  57 keyword_Double                   numeric       2        0  0%      
  58 keyword_Shuffle                  numeric       2        0  0%      
  59 keyword_Flash                    numeric       2        0  0%      
  60 keyword_Enchant                  numeric       2        0  0%      
  61 keyword_Tap                      numeric       2        0  0%      
  62 keyword_Create                   numeric       2        0  0%      
  63 keyword_Vigilance                numeric       2        0  0%      
  64 keyword_Treasure                 numeric       2        0  0%      
  65 keyword_Attach                   numeric       2        0  0%      
  66 keyword_Counter                  numeric       2        0  0%      
  67 keyword_Untap                    numeric       2        0  0%      
  68 keyword_Islandwalk               numeric       2        0  0%      
  69 keyword_Exile                    numeric       2        0  0%      
  70 keyword_Swampwalk                numeric       2        0  0%      
  71 keyword_Regenerate               numeric       2        0  0%      
  72 keyword_Ravenous                 numeric       2        0  0%      
  73 keyword_Fear                     numeric       2        0  0%      
  74 keyword_Activate                 numeric       2        0  0%      
  75 keyword_Haste                    numeric       2        0  0%      
  76 keyword_Mountainwalk             numeric       2        0  0%      
  77 keyword_Discard                  numeric       2        0  0%      
  78 keyword_Trample                  numeric       2        0  0%      
  79 keyword_Menace                   numeric       2        0  0%      
  80 keyword_Reach                    numeric       2        0  0%      
  81 keyword_Shroud                   numeric       2        0  0%      
  82 keyword_Forestwalk               numeric       2        0  0%      
  83 keyword_Hexproof                 numeric       2        0  0%      
  84 keyword_Equip                    numeric       2        0  0%      
  85 keyword_Banding                  numeric       2        0  0%      
  86 keyword_Ward                     numeric       2        0  0%      
  87 keyword_Cast                     numeric       2        0  0%      
  88 keyword_Protection               numeric       2        0  0%      
  89 keyword_Exchange                 numeric       2        0  0%      
  90 keyword_Shadow                   numeric       2        0  0%      
  91 keyword_Surge                    numeric       2        0  0%      
  92 keyword_Annihilator              numeric       2        0  0%      
  93 keyword_Indestructible           numeric       2        0  0%      
  94 keyword_Outlast                  numeric       2        0  0%      
  95 keyword_Scry                     numeric       2        0  0%      
  96 keyword_Totem armor              numeric       2        0  0%      
  97 keyword_Flashback                numeric       2        0  0%      
  98 keyword_Prowess                  numeric       2        0  0%      
  99 keyword_Evoke                    numeric       2        0  0%      
 100 keyword_Bolster                  numeric       2        0  0%      
 101 keyword_Embalm                   numeric       2        0  0%      
 102 keyword_Mill                     numeric       2        0  0%      
 103 keyword_Unearth                  numeric       2        0  0%      
 104 keyword_Deathtouch               numeric       2        0  0%      
 105 keyword_Cycling                  numeric       2        0  0%      
 106 keyword_Reveal                   numeric       2        0  0%      
 107 keyword_Undying                  numeric       2        0  0%      
 108 keyword_Basic landcycling        numeric       2        0  0%      
 109 keyword_Mentor                   numeric       2        0  0%      
 110 keyword_Suspend                  numeric       2        0  0%      
 111 keyword_Champion                 numeric       2        0  0%      
 112 keyword_Bestow                   numeric       2        0  0%      
 113 keyword_Rebound                  numeric       2        0  0%      
 114 keyword_Storm                    numeric       2        0  0%      
 115 keyword_Cascade                  numeric       2        0  0%      
 116 keyword_Evolve                   numeric       2        0  0%      
 117 keyword_Convoke                  numeric       2        0  0%      
 118 keyword_Play                     numeric       2        0  0%      
 119 keyword_Changeling               numeric       2        0  0%      
 120 keyword_Companion                numeric       2        0  0%      
 121 keyword_Scavenge                 numeric       2        0  0%      
 122 keyword_Lifelink                 numeric       2        0  0%      
 123 keyword_Dethrone                 numeric       2        0  0%      
 124 keyword_Haunt                    numeric       2        0  0%      
 125 keyword_Exalted                  numeric       2        0  0%      
 126 keyword_Double strike            numeric       2        0  0%      
 127 keyword_Fabricate                numeric       2        0  0%      
 128 keyword_Overload                 numeric       2        0  0%      
 129 keyword_Improvise                numeric       2        0  0%      
 130 keyword_Intimidate               numeric       2        0  0%      
 131 keyword_Exploit                  numeric       2        0  0%      
 132 keyword_Infect                   numeric       2        0  0%      
 133 keyword_Swampcycling             numeric       2        0  0%      
 134 keyword_Devour                   numeric       2        0  0%      
 135 keyword_Forestcycling            numeric       2        0  0%      
 136 keyword_Living weapon            numeric       2        0  0%      
 137 keyword_Sunburst                 numeric       2        0  0%      
 138 keyword_Multikicker              numeric       2        0  0%      
 139 keyword_Investigate              numeric       2        0  0%      
 140 keyword_Proliferate              numeric       2        0  0%      
 141 keyword_Miracle                  numeric       2        0  0%      
 142 keyword_Rampage                  numeric       2        0  0%      
 143 keyword_Frenzy                   numeric       2        0  0%      
 144 keyword_Echo                     numeric       2        0  0%      
 145 keyword_Crew                     numeric       2        0  0%      
 146 keyword_Escalate                 numeric       2        0  0%      
 147 keyword_Myriad                   numeric       2        0  0%      
 148 keyword_Abandon                  numeric       1        0  0%      
 149 keyword_Clash                    numeric       2        0  0%      
 150 keyword_Entwine                  numeric       2        0  0%      
 151 keyword_Affinity                 numeric       2        0  0%      
 152 keyword_Modular                  numeric       2        0  0%      
 153 keyword_Offering                 numeric       2        0  0%      
 154 keyword_Morph                    numeric       2        0  0%      
 155 keyword_Plainscycling            numeric       2        0  0%      
 156 keyword_Islandcycling            numeric       2        0  0%      
 157 keyword_Mountaincycling          numeric       2        0  0%      
 158 keyword_Megamorph                numeric       2        0  0%      
 159 keyword_Venture into the dungeon numeric       2        0  0%      
 160 keyword_Melee                    numeric       2        0  0%      
 161 keyword_Monstrosity              numeric       2        0  0%      
 162 keyword_Eternalize               numeric       2        0  0%      
 163 keyword_Extort                   numeric       2        0  0%      
 164 keyword_Goad                     numeric       2        0  0%      
 165 keyword_Spectacle                numeric       2        0  0%      
 166 keyword_Retrace                  numeric       2        0  0%      
 167 keyword_Ascend                   numeric       2        0  0%      
 168 keyword_Hideaway                 numeric       2        0  0%      
 169 keyword_Fight                    numeric       2        0  0%      
 170 keyword_Learn                    numeric       2        0  0%      
 171 keyword_Battle Cry               numeric       2        0  0%      
 172 keyword_Aftermath                numeric       2        0  0%      
 173 keyword_Afterlife                numeric       2        0  0%      
 174 keyword_Exert                    numeric       2        0  0%      
 175 keyword_Afflict                  numeric       2        0  0%      
 176 keyword_Cumulative upkeep        numeric       2        0  0%      
 177 keyword_Kicker                   numeric       2        0  0%      
 178 keyword_Blitz                    numeric       2        0  0%      
 179 keyword_Surveil                  numeric       2        0  0%      
 180 keyword_Amplify                  numeric       2        0  0%      
 181 keyword_Conspire                 numeric       2        0  0%      
 182 keyword_Graft                    numeric       2        0  0%      
 183 keyword_Desertwalk               numeric       2        0  0%      
 184 keyword_Soulbond                 numeric       2        0  0%      
 185 keyword_Madness                  numeric       2        0  0%      
 186 keyword_Riot                     numeric       2        0  0%      
 187 keyword_Partner                  numeric       2        0  0%      
 188 keyword_Assist                   numeric       2        0  0%      
 189 keyword_Support                  numeric       2        0  0%      
 190 keyword_Awaken                   numeric       2        0  0%      
 191 keyword_Devoid                   numeric       2        0  0%      
 192 keyword_Ingest                   numeric       2        0  0%      
 193 keyword_Tribute                  numeric       2        0  0%      
 194 keyword_Splice                   numeric       2        0  0%      
 195 keyword_Bushido                  numeric       2        0  0%      
 196 keyword_Soulshift                numeric       2        0  0%      
 197 keyword_Ninjutsu                 numeric       2        0  0%      
 198 keyword_Vanishing                numeric       2        0  0%      
 199 keyword_More Than Meets the Eye  numeric       2        0  0%      
 200 keyword_Prowl                    numeric       2        0  0%      
 201 keyword_Living metal             numeric       1        0  0%      
 202 keyword_Convert                  numeric       2        0  0%      
 203 keyword_Prototype                numeric       2        0  0%      
 204 keyword_Unleash                  numeric       2        0  0%      
 205 keyword_Horsemanship             numeric       2        0  0%      
 206 keyword_Forecast                 numeric       2        0  0%      
 207 keyword_Split second             numeric       2        0  0%      
 208 keyword_Persist                  numeric       2        0  0%      
 209 keyword_Reinforce                numeric       2        0  0%      
 210 keyword_Undaunted                numeric       2        0  0%      
 211 keyword_Flanking                 numeric       2        0  0%      
 212 keyword_Delve                    numeric       2        0  0%      
 213 keyword_Dredge                   numeric       2        0  0%      
 214 keyword_Cipher                   numeric       2        0  0%      
 215 keyword_Bloodthirst              numeric       2        0  0%      
 216 keyword_Dash                     numeric       2        0  0%      
 217 keyword_Commander ninjutsu       numeric       2        0  0%      
 218 keyword_Manifest                 numeric       2        0  0%      
 219 keyword_Populate                 numeric       2        0  0%      
 220 keyword_Jump-start               numeric       2        0  0%      
 221 keyword_Mutate                   numeric       2        0  0%      
 222 keyword_Food                     numeric       2        0  0%      
 223 keyword_Demonstrate              numeric       2        0  0%      
 224 keyword_Encore                   numeric       2        0  0%      
 225 keyword_Adapt                    numeric       2        0  0%      
 226 keyword_Toxic                    numeric       2        0  0%      
 227 keyword_Conjure                  numeric       2        0  0%      
 228 keyword_Replicate                numeric       2        0  0%      
 229 keyword_Escape                   numeric       2        0  0%      
 230 keyword_Foretell                 numeric       2        0  0%      
 231 keyword_Skulk                    numeric       2        0  0%      
 232 keyword_Buyback                  numeric       2        0  0%      
 233 keyword_Planeswalk               numeric       1        0  0%      
 234 keyword_Training                 numeric       2        0  0%      
 235 keyword_Emerge                   numeric       2        0  0%      
 236 keyword_Renown                   numeric       2        0  0%      
 237 keyword_Fuse                     numeric       2        0  0%      
 238 keyword_Hidden agenda            numeric       1        0  0%      
 239 keyword_Double agenda            numeric       1        0  0%      
 240 keyword_Recover                  numeric       2        0  0%      
 241 keyword_Ripple                   numeric       2        0  0%      
 242 keyword_Fading                   numeric       2        0  0%      
 243 keyword_Detain                   numeric       2        0  0%      
 244 keyword_Transform                numeric       2        0  0%      
 245 keyword_Enlist                   numeric       2        0  0%      
 246 keyword_Phasing                  numeric       2        0  0%      
 247 keyword_Compleated               numeric       2        0  0%      
 248 keyword_Bargain                  numeric       2        0  0%      
 249 keyword_Wither                   numeric       2        0  0%      
 250 keyword_Wizardcycling            numeric       2        0  0%      
 251 keyword_Gravestorm               numeric       2        0  0%      
 252 keyword_Transfigure              numeric       2        0  0%      
 253 keyword_Slivercycling            numeric       2        0  0%      
 254 keyword_Fortify                  numeric       2        0  0%      
 255 keyword_Transmute                numeric       2        0  0%      
 256 keyword_Nonbasic landwalk        numeric       2        0  0%      
 257 keyword_Assemble                 numeric       2        0  0%      
 258 keyword_Seek                     numeric       2        0  0%      
 259 keyword_Boast                    numeric       2        0  0%      
 260 keyword_Provoke                  numeric       2        0  0%      
 261 keyword_Plainswalk               numeric       2        0  0%      
 262 keyword_Disturb                  numeric       2        0  0%      
 263 keyword_Daybound                 numeric       2        0  0%      
 264 keyword_Nightbound               numeric       1        0  0%      
 265 keyword_Backup                   numeric       2        0  0%      
 266 keyword_Incubate                 numeric       2        0  0%      
 267 keyword_Casualty                 numeric       2        0  0%      
 268 keyword_Reconfigure              numeric       2        0  0%      
 269 keyword_Epic                     numeric       2        0  0%      
 270 keyword_Legendary landwalk       numeric       2        0  0%      
 271 keyword_Augment                  numeric       1        0  0%      
 272 keyword_Open an Attraction       numeric       2        0  0%      
 273 keyword_Cleave                   numeric       2        0  0%      
 274 keyword_Amass                    numeric       2        0  0%      
 275 number_of_keywords               numeric       7        0  0%      
 276 multicolor_with_colorless        numeric       2        0  0%      

Numeric Variables
                                     n      mean        sd   skew min    p25
multiverse_id                    41081 336394.65 208195.09  -0.44   1 130385
converted_mana_cost              41081      3.76      1.62   1.01   0      3
power                            23285      2.75      1.78   1.25  -1      2
toughness                        23285      2.97      1.78   1.19  -1      2
red_cost                         41081      0.25      0.55   2.27   0      0
green_cost                       41081      0.26      0.57   2.34   0      0
blue_cost                        41081      0.25      0.56   2.28   0      0
white_cost                       41081      0.25      0.55   2.28   0      0
black_cost                       41081      0.26      0.58   2.30   0      0
colorless_cost                   41081      2.48      1.43   1.45   0      1
multicolor                       41081      0.10      0.30   2.66   0      0
color_red                        41081      0.20      0.40   1.53   0      0
color_green                      41081      0.20      0.40   1.49   0      0
color_blue                       41081      0.20      0.40   1.53   0      0
color_white                      41081      0.20      0.40   1.51   0      0
color_black                      41081      0.20      0.40   1.52   0      0
color_colorless                  41081      1.00      0.07 -15.05   0      1
color_identity_red               41081      0.21      0.41   1.44   0      0
color_identity_green             41081      0.21      0.41   1.42   0      0
color_identity_blue              41081      0.32      0.47   0.78   0      0
color_identity_white             41081      0.21      0.41   1.43   0      0
color_identity_black             41081      0.21      0.41   1.42   0      0
variable_power                   41081      0.00      0.05  21.66   0      0
variable_toughness               41081      0.00      0.05  21.66   0      0
creature                         41081      0.56      0.50  -0.26   0      0
land                             41081      0.00      0.00    NaN   0      0
artifact                         41081      0.14      0.35   2.07   0      0
enchantment                      41081      0.11      0.31   2.53   0      0
planeswalker                     41081      0.01      0.11   8.51   0      0
battle                           41081      0.00      0.03  38.26   0      0
instant                          41081      0.11      0.31   2.55   0      0
sorcery                          41081      0.12      0.32   2.38   0      0
multitype                        41081      0.05      0.22   4.16   0      0
number_of_same_cards             41081     35.32    117.09   4.10   1      2
keyword_First strike             41081      0.01      0.10   9.93   0      0
keyword_NA                       41081      0.00      0.00    NaN   0      0
keyword_Flying                   41081      0.12      0.32   2.41   0      0
keyword_Defender                 41081      0.01      0.11   9.00   0      0
keyword_Sacrifice                41081      0.06      0.24   3.60   0      0
keyword_Destroy                  41081      0.05      0.21   4.22   0      0
keyword_Squad                    41081      0.00      0.02  40.50   0      0
keyword_Double                   41081      0.00      0.03  29.51   0      0
keyword_Shuffle                  41081      0.00      0.04  24.34   0      0
keyword_Flash                    41081      0.02      0.13   7.56   0      0
keyword_Enchant                  41081      0.04      0.19   4.84   0      0
keyword_Tap                      41081      0.02      0.13   7.51   0      0
keyword_Create                   41081      0.04      0.19   4.82   0      0
keyword_Vigilance                41081      0.01      0.11   9.18   0      0
keyword_Treasure                 41081      0.01      0.09  11.04   0      0
keyword_Attach                   41081      0.01      0.09  10.92   0      0
keyword_Counter                  41081      0.01      0.11   8.61   0      0
keyword_Untap                    41081      0.01      0.11   8.58   0      0
keyword_Islandwalk               41081      0.00      0.04  25.68   0      0
keyword_Exile                    41081      0.04      0.20   4.61   0      0
keyword_Swampwalk                41081      0.00      0.04  23.34   0      0
keyword_Regenerate               41081      0.01      0.10   9.59   0      0
keyword_Ravenous                 41081      0.00      0.03  30.86   0      0
keyword_Fear                     41081      0.00      0.05  21.66   0      0
keyword_Activate                 41081      0.02      0.14   6.70   0      0
keyword_Haste                    41081      0.01      0.10   9.60   0      0
keyword_Mountainwalk             41081      0.00      0.02  44.19   0      0
keyword_Discard                  41081      0.03      0.17   5.70   0      0
keyword_Trample                  41081      0.02      0.14   6.66   0      0
keyword_Menace                   41081      0.01      0.08  12.75   0      0
keyword_Reach                    41081      0.01      0.09  10.82   0      0
keyword_Shroud                   41081      0.00      0.04  24.89   0      0
keyword_Forestwalk               41081      0.00      0.03  32.41   0      0
keyword_Hexproof                 41081      0.00      0.05  20.61   0      0
keyword_Equip                    41081      0.02      0.14   7.12   0      0
keyword_Banding                  41081      0.00      0.02  54.14   0      0
keyword_Ward                     41081      0.00      0.05  21.79   0      0
keyword_Cast                     41081      0.00      0.07  14.12   0      0
keyword_Protection               41081      0.00      0.06  16.80   0      0
keyword_Exchange                 41081      0.00      0.03  29.83   0      0
keyword_Shadow                   41081      0.00      0.04  25.28   0      0
keyword_Surge                    41081      0.00      0.02  49.13   0      0
keyword_Annihilator              41081      0.00      0.03  33.27   0      0
keyword_Indestructible           41081      0.00      0.05  19.07   0      0
keyword_Outlast                  41081      0.00      0.03  36.96   0      0
keyword_Scry                     41081      0.00      0.07  15.01   0      0
keyword_Totem armor              41081      0.00      0.03  36.36   0      0
keyword_Flashback                41081      0.01      0.08  11.99   0      0
keyword_Prowess                  41081      0.00      0.04  22.31   0      0
keyword_Evoke                    41081      0.00      0.05  20.09   0      0
keyword_Bolster                  41081      0.00      0.02  56.19   0      0
keyword_Embalm                   41081      0.00      0.02  42.23   0      0
keyword_Mill                     41081      0.00      0.05  21.06   0      0
keyword_Unearth                  41081      0.00      0.05  20.40   0      0
keyword_Deathtouch               41081      0.01      0.08  12.26   0      0
keyword_Cycling                  41081      0.01      0.10  10.32   0      0
keyword_Reveal                   41081      0.01      0.08  12.14   0      0
keyword_Undying                  41081      0.00      0.03  35.24   0      0
keyword_Basic landcycling        41081      0.00      0.03  28.90   0      0
keyword_Mentor                   41081      0.00      0.03  33.74   0      0
keyword_Suspend                  41081      0.00      0.05  18.74   0      0
keyword_Champion                 41081      0.00      0.05  19.34   0      0
keyword_Bestow                   41081      0.00      0.03  32.41   0      0
keyword_Rebound                  41081      0.00      0.03  32.41   0      0
keyword_Storm                    41081      0.00      0.06  16.86   0      0
keyword_Cascade                  41081      0.00      0.05  22.05   0      0
keyword_Evolve                   41081      0.00      0.03  38.97   0      0
keyword_Convoke                  41081      0.00      0.06  17.49   0      0
keyword_Play                     41081      0.00      0.03  36.96   0      0
keyword_Changeling               41081      0.00      0.05  21.29   0      0
keyword_Companion                41081      0.00      0.03  33.74   0      0
keyword_Scavenge                 41081      0.00      0.02  45.29   0      0
keyword_Lifelink                 41081      0.00      0.06  15.45   0      0
keyword_Dethrone                 41081      0.00      0.02  54.14   0      0
keyword_Haunt                    41081      0.00      0.02  54.14   0      0
keyword_Exalted                  41081      0.00      0.03  32.00   0      0
keyword_Double strike            41081      0.00      0.05  19.90   0      0
keyword_Fabricate                41081      0.00      0.03  37.60   0      0
keyword_Overload                 41081      0.00      0.02  40.50   0      0
keyword_Improvise                41081      0.00      0.03  34.72   0      0
keyword_Intimidate               41081      0.00      0.03  34.21   0      0
keyword_Exploit                  41081      0.00      0.02  41.34   0      0
keyword_Infect                   41081      0.00      0.04  28.05   0      0
keyword_Swampcycling             41081      0.00      0.02  54.14   0      0
keyword_Devour                   41081      0.00      0.03  31.61   0      0
keyword_Forestcycling            41081      0.00      0.02  58.48   0      0
keyword_Living weapon            41081      0.00      0.03  32.41   0      0
keyword_Sunburst                 41081      0.00      0.02  40.50   0      0
keyword_Multikicker              41081      0.00      0.03  33.27   0      0
keyword_Investigate              41081      0.00      0.02  40.50   0      0
keyword_Proliferate              41081      0.00      0.03  30.86   0      0
keyword_Miracle                  41081      0.00      0.02  43.18   0      0
keyword_Rampage                  41081      0.00      0.02  43.18   0      0
keyword_Frenzy                   41081      0.00      0.01 143.30   0      0
keyword_Echo                     41081      0.00      0.05  20.30   0      0
keyword_Crew                     41081      0.00      0.06  17.76   0      0
keyword_Escalate                 41081      0.00      0.02  54.14   0      0
keyword_Myriad                   41081      0.00      0.02  47.74   0      0
keyword_Abandon                  41081      0.00      0.00    NaN   0      0
keyword_Clash                    41081      0.00      0.02  46.47   0      0
keyword_Entwine                  41081      0.00      0.03  31.23   0      0
keyword_Affinity                 41081      0.00      0.04  24.52   0      0
keyword_Modular                  41081      0.00      0.03  36.36   0      0
keyword_Offering                 41081      0.00      0.01  82.72   0      0
keyword_Morph                    41081      0.01      0.07  13.43   0      0
keyword_Plainscycling            41081      0.00      0.02  46.47   0      0
keyword_Islandcycling            41081      0.00      0.01  76.59   0      0
keyword_Mountaincycling          41081      0.00      0.02  50.64   0      0
keyword_Megamorph                41081      0.00      0.03  33.74   0      0
keyword_Venture into the dungeon 41081      0.00      0.01  71.64   0      0
keyword_Melee                    41081      0.00      0.02  50.64   0      0
keyword_Monstrosity              41081      0.00      0.04  26.11   0      0
keyword_Eternalize               41081      0.00      0.02  43.18   0      0
keyword_Extort                   41081      0.00      0.02  44.19   0      0
keyword_Goad                     41081      0.00      0.02  40.50   0      0
keyword_Spectacle                41081      0.00      0.02  56.19   0      0
keyword_Retrace                  41081      0.00      0.03  37.60   0      0
keyword_Ascend                   41081      0.00      0.02  44.19   0      0
keyword_Hideaway                 41081      0.00      0.02  58.48   0      0
keyword_Fight                    41081      0.00      0.01 101.32   0      0
keyword_Learn                    41081      0.00      0.02  54.14   0      0
keyword_Battle Cry               41081      0.00      0.01 143.30   0      0
keyword_Aftermath                41081      0.00      0.04  27.27   0      0
keyword_Afterlife                41081      0.00      0.02  58.48   0      0
keyword_Exert                    41081      0.00      0.02  61.08   0      0
keyword_Afflict                  41081      0.00      0.02  54.14   0      0
keyword_Cumulative upkeep        41081      0.00      0.05  20.72   0      0
keyword_Kicker                   41081      0.01      0.08  12.33   0      0
keyword_Blitz                    41081      0.00      0.02  41.34   0      0
keyword_Surveil                  41081      0.00      0.03  39.71   0      0
keyword_Amplify                  41081      0.00      0.02  61.08   0      0
keyword_Conspire                 41081      0.00      0.02  61.08   0      0
keyword_Graft                    41081      0.00      0.02  42.23   0      0
keyword_Desertwalk               41081      0.00      0.00 202.67   0      0
keyword_Soulbond                 41081      0.00      0.03  36.96   0      0
keyword_Madness                  41081      0.00      0.06  17.42   0      0
keyword_Riot                     41081      0.00      0.02  56.19   0      0
keyword_Partner                  41081      0.00      0.06  15.54   0      0
keyword_Assist                   41081      0.00      0.02  54.14   0      0
keyword_Support                  41081      0.00      0.02  64.07   0      0
keyword_Awaken                   41081      0.00      0.02  46.47   0      0
keyword_Devoid                   41081      0.00      0.05  20.61   0      0
keyword_Ingest                   41081      0.00      0.01  76.59   0      0
keyword_Tribute                  41081      0.00      0.02  58.48   0      0
keyword_Splice                   41081      0.00      0.03  34.72   0      0
keyword_Bushido                  41081      0.00      0.03  35.24   0      0
keyword_Soulshift                41081      0.00      0.03  38.26   0      0
keyword_Ninjutsu                 41081      0.00      0.04  22.88   0      0
keyword_Vanishing                41081      0.00      0.03  36.36   0      0
keyword_More Than Meets the Eye  41081      0.00      0.03  37.60   0      0
keyword_Prowl                    41081      0.00      0.02  47.74   0      0
keyword_Living metal             41081      0.00      0.00    NaN   0      0
keyword_Convert                  41081      0.00      0.01 117.00   0      0
keyword_Prototype                41081      0.00      0.03  35.79   0      0
keyword_Unleash                  41081      0.00      0.02  41.34   0      0
keyword_Horsemanship             41081      0.00      0.03  32.00   0      0
keyword_Forecast                 41081      0.00      0.02  64.07   0      0
keyword_Split second             41081      0.00      0.03  32.00   0      0
keyword_Persist                  41081      0.00      0.03  30.86   0      0
keyword_Reinforce                41081      0.00      0.02  61.08   0      0
keyword_Undaunted                41081      0.00      0.01  71.64   0      0
keyword_Flanking                 41081      0.00      0.03  33.27   0      0
keyword_Delve                    41081      0.00      0.03  29.51   0      0
keyword_Dredge                   41081      0.00      0.03  32.83   0      0
keyword_Cipher                   41081      0.00      0.02  49.13   0      0
keyword_Bloodthirst              41081      0.00      0.03  31.23   0      0
keyword_Dash                     41081      0.00      0.02  44.19   0      0
keyword_Commander ninjutsu       41081      0.00      0.01 143.30   0      0
keyword_Manifest                 41081      0.00      0.02  46.47   0      0
keyword_Populate                 41081      0.00      0.01  82.72   0      0
keyword_Jump-start               41081      0.00      0.02  61.08   0      0
keyword_Mutate                   41081      0.00      0.03  30.86   0      0
keyword_Food                     41081      0.00      0.03  29.83   0      0
keyword_Demonstrate              41081      0.00      0.02  64.07   0      0
keyword_Encore                   41081      0.00      0.02  42.23   0      0
keyword_Adapt                    41081      0.00      0.02  50.64   0      0
keyword_Toxic                    41081      0.00      0.03  33.74   0      0
keyword_Conjure                  41081      0.00      0.02  58.48   0      0
keyword_Replicate                41081      0.00      0.02  52.30   0      0
keyword_Escape                   41081      0.00      0.02  42.23   0      0
keyword_Foretell                 41081      0.00      0.04  26.56   0      0
keyword_Skulk                    41081      0.00      0.02  52.30   0      0
keyword_Buyback                  41081      0.00      0.03  33.74   0      0
keyword_Planeswalk               41081      0.00      0.00    NaN   0      0
keyword_Training                 41081      0.00      0.02  52.30   0      0
keyword_Emerge                   41081      0.00      0.02  47.74   0      0
keyword_Renown                   41081      0.00      0.02  41.34   0      0
keyword_Fuse                     41081      0.00      0.03  36.96   0      0
keyword_Hidden agenda            41081      0.00      0.00    NaN   0      0
keyword_Double agenda            41081      0.00      0.00    NaN   0      0
keyword_Recover                  41081      0.00      0.01  82.72   0      0
keyword_Ripple                   41081      0.00      0.01  90.62   0      0
keyword_Fading                   41081      0.00      0.02  41.34   0      0
keyword_Detain                   41081      0.00      0.01 143.30   0      0
keyword_Transform                41081      0.00      0.05  19.99   0      0
keyword_Enlist                   41081      0.00      0.02  56.19   0      0
keyword_Phasing                  41081      0.00      0.02  58.48   0      0
keyword_Compleated               41081      0.00      0.02  41.34   0      0
keyword_Bargain                  41081      0.00      0.01 143.30   0      0
keyword_Wither                   41081      0.00      0.02  44.19   0      0
keyword_Wizardcycling            41081      0.00      0.01 117.00   0      0
keyword_Gravestorm               41081      0.00      0.00 202.67   0      0
keyword_Transfigure              41081      0.00      0.00 202.67   0      0
keyword_Slivercycling            41081      0.00      0.01 117.00   0      0
keyword_Fortify                  41081      0.00      0.00 202.67   0      0
keyword_Transmute                41081      0.00      0.02  61.08   0      0
keyword_Nonbasic landwalk        41081      0.00      0.00 202.67   0      0
keyword_Assemble                 41081      0.00      0.01  71.64   0      0
keyword_Seek                     41081      0.00      0.02  61.08   0      0
keyword_Boast                    41081      0.00      0.02  50.64   0      0
keyword_Provoke                  41081      0.00      0.01  67.54   0      0
keyword_Plainswalk               41081      0.00      0.01  90.62   0      0
keyword_Disturb                  41081      0.00      0.02  42.23   0      0
keyword_Daybound                 41081      0.00      0.03  31.61   0      0
keyword_Nightbound               41081      0.00      0.00    NaN   0      0
keyword_Backup                   41081      0.00      0.03  34.21   0      0
keyword_Incubate                 41081      0.00      0.02  61.08   0      0
keyword_Casualty                 41081      0.00      0.02  47.74   0      0
keyword_Reconfigure              41081      0.00      0.03  36.36   0      0
keyword_Epic                     41081      0.00      0.01  90.62   0      0
keyword_Legendary landwalk       41081      0.00      0.00 202.67   0      0
keyword_Augment                  41081      0.00      0.00    NaN   0      0
keyword_Open an Attraction       41081      0.00      0.01 117.00   0      0
keyword_Cleave                   41081      0.00      0.02  56.19   0      0
keyword_Amass                    41081      0.00      0.02  61.08   0      0
number_of_keywords               41081      0.79      0.83   1.07   0      0
multicolor_with_colorless        41081      0.87      0.33  -2.24   0      1
                                 median    p75    max
multiverse_id                    409965 509340 616528
converted_mana_cost                   3      5     16
power                                 2      4     18
toughness                             3      4     17
red_cost                              0      0      4
green_cost                            0      0      4
blue_cost                             0      0      4
white_cost                            0      0      4
black_cost                            0      0      4
colorless_cost                        2      3     16
multicolor                            0      0      1
color_red                             0      0      1
color_green                           0      0      1
color_blue                            0      0      1
color_white                           0      0      1
color_black                           0      0      1
color_colorless                       1      1      1
color_identity_red                    0      0      1
color_identity_green                  0      0      1
color_identity_blue                   0      1      1
color_identity_white                  0      0      1
color_identity_black                  0      0      1
variable_power                        0      0      1
variable_toughness                    0      0      1
creature                              1      1      1
land                                  0      0      0
artifact                              0      0      1
enchantment                           0      0      1
planeswalker                          0      0      1
battle                                0      0      1
instant                               0      0      1
sorcery                               0      0      1
multitype                             0      0      1
number_of_same_cards                  5     12    555
keyword_First strike                  0      0      1
keyword_NA                            0      0      0
keyword_Flying                        0      0      1
keyword_Defender                      0      0      1
keyword_Sacrifice                     0      0      1
keyword_Destroy                       0      0      1
keyword_Squad                         0      0      1
keyword_Double                        0      0      1
keyword_Shuffle                       0      0      1
keyword_Flash                         0      0      1
keyword_Enchant                       0      0      1
keyword_Tap                           0      0      1
keyword_Create                        0      0      1
keyword_Vigilance                     0      0      1
keyword_Treasure                      0      0      1
keyword_Attach                        0      0      1
keyword_Counter                       0      0      1
keyword_Untap                         0      0      1
keyword_Islandwalk                    0      0      1
keyword_Exile                         0      0      1
keyword_Swampwalk                     0      0      1
keyword_Regenerate                    0      0      1
keyword_Ravenous                      0      0      1
keyword_Fear                          0      0      1
keyword_Activate                      0      0      1
keyword_Haste                         0      0      1
keyword_Mountainwalk                  0      0      1
keyword_Discard                       0      0      1
keyword_Trample                       0      0      1
keyword_Menace                        0      0      1
keyword_Reach                         0      0      1
keyword_Shroud                        0      0      1
keyword_Forestwalk                    0      0      1
keyword_Hexproof                      0      0      1
keyword_Equip                         0      0      1
keyword_Banding                       0      0      1
keyword_Ward                          0      0      1
keyword_Cast                          0      0      1
keyword_Protection                    0      0      1
keyword_Exchange                      0      0      1
keyword_Shadow                        0      0      1
keyword_Surge                         0      0      1
keyword_Annihilator                   0      0      1
keyword_Indestructible                0      0      1
keyword_Outlast                       0      0      1
keyword_Scry                          0      0      1
keyword_Totem armor                   0      0      1
keyword_Flashback                     0      0      1
keyword_Prowess                       0      0      1
keyword_Evoke                         0      0      1
keyword_Bolster                       0      0      1
keyword_Embalm                        0      0      1
keyword_Mill                          0      0      1
keyword_Unearth                       0      0      1
keyword_Deathtouch                    0      0      1
keyword_Cycling                       0      0      1
keyword_Reveal                        0      0      1
keyword_Undying                       0      0      1
keyword_Basic landcycling             0      0      1
keyword_Mentor                        0      0      1
keyword_Suspend                       0      0      1
keyword_Champion                      0      0      1
keyword_Bestow                        0      0      1
keyword_Rebound                       0      0      1
keyword_Storm                         0      0      1
keyword_Cascade                       0      0      1
keyword_Evolve                        0      0      1
keyword_Convoke                       0      0      1
keyword_Play                          0      0      1
keyword_Changeling                    0      0      1
keyword_Companion                     0      0      1
keyword_Scavenge                      0      0      1
keyword_Lifelink                      0      0      1
keyword_Dethrone                      0      0      1
keyword_Haunt                         0      0      1
keyword_Exalted                       0      0      1
keyword_Double strike                 0      0      1
keyword_Fabricate                     0      0      1
keyword_Overload                      0      0      1
keyword_Improvise                     0      0      1
keyword_Intimidate                    0      0      1
keyword_Exploit                       0      0      1
keyword_Infect                        0      0      1
keyword_Swampcycling                  0      0      1
keyword_Devour                        0      0      1
keyword_Forestcycling                 0      0      1
keyword_Living weapon                 0      0      1
keyword_Sunburst                      0      0      1
keyword_Multikicker                   0      0      1
keyword_Investigate                   0      0      1
keyword_Proliferate                   0      0      1
keyword_Miracle                       0      0      1
keyword_Rampage                       0      0      1
keyword_Frenzy                        0      0      1
keyword_Echo                          0      0      1
keyword_Crew                          0      0      1
keyword_Escalate                      0      0      1
keyword_Myriad                        0      0      1
keyword_Abandon                       0      0      0
keyword_Clash                         0      0      1
keyword_Entwine                       0      0      1
keyword_Affinity                      0      0      1
keyword_Modular                       0      0      1
keyword_Offering                      0      0      1
keyword_Morph                         0      0      1
keyword_Plainscycling                 0      0      1
keyword_Islandcycling                 0      0      1
keyword_Mountaincycling               0      0      1
keyword_Megamorph                     0      0      1
keyword_Venture into the dungeon      0      0      1
keyword_Melee                         0      0      1
keyword_Monstrosity                   0      0      1
keyword_Eternalize                    0      0      1
keyword_Extort                        0      0      1
keyword_Goad                          0      0      1
keyword_Spectacle                     0      0      1
keyword_Retrace                       0      0      1
keyword_Ascend                        0      0      1
keyword_Hideaway                      0      0      1
keyword_Fight                         0      0      1
keyword_Learn                         0      0      1
keyword_Battle Cry                    0      0      1
keyword_Aftermath                     0      0      1
keyword_Afterlife                     0      0      1
keyword_Exert                         0      0      1
keyword_Afflict                       0      0      1
keyword_Cumulative upkeep             0      0      1
keyword_Kicker                        0      0      1
keyword_Blitz                         0      0      1
keyword_Surveil                       0      0      1
keyword_Amplify                       0      0      1
keyword_Conspire                      0      0      1
keyword_Graft                         0      0      1
keyword_Desertwalk                    0      0      1
keyword_Soulbond                      0      0      1
keyword_Madness                       0      0      1
keyword_Riot                          0      0      1
keyword_Partner                       0      0      1
keyword_Assist                        0      0      1
keyword_Support                       0      0      1
keyword_Awaken                        0      0      1
keyword_Devoid                        0      0      1
keyword_Ingest                        0      0      1
keyword_Tribute                       0      0      1
keyword_Splice                        0      0      1
keyword_Bushido                       0      0      1
keyword_Soulshift                     0      0      1
keyword_Ninjutsu                      0      0      1
keyword_Vanishing                     0      0      1
keyword_More Than Meets the Eye       0      0      1
keyword_Prowl                         0      0      1
keyword_Living metal                  0      0      0
keyword_Convert                       0      0      1
keyword_Prototype                     0      0      1
keyword_Unleash                       0      0      1
keyword_Horsemanship                  0      0      1
keyword_Forecast                      0      0      1
keyword_Split second                  0      0      1
keyword_Persist                       0      0      1
keyword_Reinforce                     0      0      1
keyword_Undaunted                     0      0      1
keyword_Flanking                      0      0      1
keyword_Delve                         0      0      1
keyword_Dredge                        0      0      1
keyword_Cipher                        0      0      1
keyword_Bloodthirst                   0      0      1
keyword_Dash                          0      0      1
keyword_Commander ninjutsu            0      0      1
keyword_Manifest                      0      0      1
keyword_Populate                      0      0      1
keyword_Jump-start                    0      0      1
keyword_Mutate                        0      0      1
keyword_Food                          0      0      1
keyword_Demonstrate                   0      0      1
keyword_Encore                        0      0      1
keyword_Adapt                         0      0      1
keyword_Toxic                         0      0      1
keyword_Conjure                       0      0      1
keyword_Replicate                     0      0      1
keyword_Escape                        0      0      1
keyword_Foretell                      0      0      1
keyword_Skulk                         0      0      1
keyword_Buyback                       0      0      1
keyword_Planeswalk                    0      0      0
keyword_Training                      0      0      1
keyword_Emerge                        0      0      1
keyword_Renown                        0      0      1
keyword_Fuse                          0      0      1
keyword_Hidden agenda                 0      0      0
keyword_Double agenda                 0      0      0
keyword_Recover                       0      0      1
keyword_Ripple                        0      0      1
keyword_Fading                        0      0      1
keyword_Detain                        0      0      1
keyword_Transform                     0      0      1
keyword_Enlist                        0      0      1
keyword_Phasing                       0      0      1
keyword_Compleated                    0      0      1
keyword_Bargain                       0      0      1
keyword_Wither                        0      0      1
keyword_Wizardcycling                 0      0      1
keyword_Gravestorm                    0      0      1
keyword_Transfigure                   0      0      1
keyword_Slivercycling                 0      0      1
keyword_Fortify                       0      0      1
keyword_Transmute                     0      0      1
keyword_Nonbasic landwalk             0      0      1
keyword_Assemble                      0      0      1
keyword_Seek                          0      0      1
keyword_Boast                         0      0      1
keyword_Provoke                       0      0      1
keyword_Plainswalk                    0      0      1
keyword_Disturb                       0      0      1
keyword_Daybound                      0      0      1
keyword_Nightbound                    0      0      0
keyword_Backup                        0      0      1
keyword_Incubate                      0      0      1
keyword_Casualty                      0      0      1
keyword_Reconfigure                   0      0      1
keyword_Epic                          0      0      1
keyword_Legendary landwalk            0      0      1
keyword_Augment                       0      0      0
keyword_Open an Attraction            0      0      1
keyword_Cleave                        0      0      1
keyword_Amass                         0      0      1
number_of_keywords                    1      1      6
multicolor_with_colorless             1      1      1

Categorical Variables
 variable              level                n     pct 
 name                  A Good Thing             4 0.00
                       A-Bretagard Strongho     2 0.00
                       A-Cosmos Elixir          2 0.00
                       A-Dungeon Descent        2 0.00
                       A-Elderfang Ritualis     1 0.00
                       A-Fires of Invention     1 0.00
                       A-Haywire Mite           2 0.00
                       A-Skemfar Elderhall      2 0.00
                       A-Vega, the Watcher      1 0.00
                       Aarakocra Sneak          2 0.00
                       (12126 more levels)  41062 1.00
 layout                adventure              140 0.00
                       aftermath              108 0.00
                       class                    3 0.00
                       flip                    22 0.00
                       host                    26 0.00
                       leveler                 26 0.00
                       meld                    15 0.00
                       modal_dfc              139 0.00
                       mutate                  52 0.00
                       normal               39951 0.97
                       (4 more levels)        599 0.01
 mana_cost             {0}                    179 0.00
                       {1}                    653 0.02
                       {1}{B}                1263 0.03
                       {1}{B}{B}              483 0.01
                       {1}{B}{B}{B}            21 0.00
                       {1}{B}{B}{B}{B}          4 0.00
                       {1}{B}{B}{B}{G}{G}{G     2 0.00
                       {1}{B}{B}{G}             3 0.00
                       {1}{B}{B}{R}{R}          2 0.00
                       {1}{B}{B/G}{G}           1 0.00
                       (515 more levels)    38470 0.94
 type                  Artifact              2880 0.07
                       Artifact — Clue          4 0.00
                       Artifact — Equipment   706 0.02
                       Artifact — Equipment     1 0.00
                       Artifact — Food          1 0.00
                       Artifact — Fortifica     1 0.00
                       Artifact — Treasure      6 0.00
                       Artifact — Vehicle     110 0.00
                       Artifact Creature —     21 0.00
                       Artifact Creature —      1 0.00
                       (2372 more levels)   37350 0.91
 rarity                Bonus                    8 0.00
                       Common               12948 0.32
                       Mythic                2951 0.07
                       Rare                 12868 0.31
                       Special                182 0.00
                       Uncommon             12124 0.30
 flavor                . . . aaaaaaiiii . .     1 0.00
                       . . . but the price      2 0.00
                       . . . iiiiiiinnnn .      1 0.00
                       . . . nnnnnssssss!       1 0.00
                       . . . that exciting      1 0.00
                       'Twas in the bogs of     5 0.00
                       'Twas in the bogs of     1 0.00
                       " . . . [W]hen the t     1 0.00
                       " . . . And the thir     2 0.00
                       " . . . and you must     1 0.00
                       (15713 more levels)  24376 1.00
 set_name              Adventures in the Fo   283 0.01
                       Aether Revolt          170 0.00
                       Alara Reborn           106 0.00
                       Alchemy Horizons: Ba   226 0.01
                       Alchemy: Innistrad      54 0.00
                       Alchemy: Kamigawa       22 0.00
                       Alchemy: New Capenna    18 0.00
                       Alliances              163 0.00
                       Amonkhet               225 0.01
                       Amonkhet Invocations    43 0.00
                       (280 more levels)    39771 0.97
 combined_general_type artifact              3951 0.10
                       artifact_enchantment     8 0.00
                       battle                  28 0.00
                       creature             21130 0.51
                       creature_artifact     1802 0.04
                       creature_enchantment   220 0.01
                       creature_instant         2 0.00
                       enchantment           4204 0.10
                       instant               4381 0.11
                       planeswalker           545 0.01
                       (1 more levels)       4806 0.12
 mana_cost_q           high cost            11403 0.28
                       low cost              9356 0.23
                       medium-high cost      9054 0.22
                       medium-low cost      11268 0.27
 mana_cost_t           high cost            11403 0.28
                       low cost              9356 0.23
                       medium cost          20322 0.49</code></pre>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/df overview graphs_5952ff29557e795dcc4f8ae7b9c6e810">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">names</span>, <span class="op">-</span><span class="va">source</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">#dplyr::select(-c(color_identity,legalitites, colors, supertypes, rulings, variations,names,source,printings) ) %&gt;%</span></span>
<span>  <span class="fu">barcharts</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>The following variable had more than 20 levels and were not graphed:
 name mana_cost type text flavor set_name </code></pre>
</div>
<div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/df overview graphs-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># df %&gt;%dplyr::select(-starts_with("keyword_")) %&gt;% densities()</span></span>
<span><span class="va">df</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"cost"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">densities</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/df overview graphs-2.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"color"</span><span class="op">)</span>, <span class="op">-</span><span class="va">colorless_cost</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">densities</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/df overview graphs-3.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"variable"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">densities</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/df overview graphs-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I’ve mostly only seen a handful of cards my friends play with, and my doctor who deck, so I’m curious if there’s any correlation between the toughness, power, and mana. On a first glance you’d expect it, if a character is tougher it can withstand more, if it’s got a higher power it can hit harder, and so forth. However, at least somewhat frequently the reason a character is useful is because it has some useful skill. For example, I’ve got a card that doesn’t hit hard or have high defense, but it costs a decent bit of mana (for my deck) because every time I attack I can play the top of my deck.</p>
<div class="cell" data-hash="magicTheGathering_cache/html/graph toughness vs power_7b47211974685987bd1186cf4a460475">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ggplotly(</span></span>
<span>  <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">type</span>,<span class="st">"Creature"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">toughness</span>,<span class="va">power</span>,<span class="va">converted_mana_cost</span>, <span class="va">name</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">toughness</span>,y<span class="op">=</span><span class="va">power</span>,color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">converted_mana_cost</span><span class="op">)</span>, text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"name: "</span>,<span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      title<span class="op">=</span><span class="st">"Magic the Gathering Toughness vs Power"</span>,</span>
<span>      x<span class="op">=</span><span class="st">"Toughness (Hit Points)"</span>,</span>
<span>      y<span class="op">=</span><span class="st">"Power"</span>,</span>
<span>      color<span class="op">=</span><span class="st">"Total Mana Cost"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/graph toughness vs power-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There seems to be overall a strong trend between toughness and power above values around 7, and that the mana cost follows a similar trend.</p>
</section><section id="text" class="level1"><h1>Text</h1>
<div class="cell" data-hash="magicTheGathering_cache/html/create and graph tfidf_c18914f4f333b8845642969c51c477ef">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># data("stop_words")</span></span>
<span></span>
<span><span class="co"># word_frequency &lt;- Txtdf %&gt;% </span></span>
<span><span class="co">#   unnest_tokens(word,flavor, to_lower = TRUE) %&gt;% </span></span>
<span><span class="co">#   #dplyr::select(color,word) %&gt;% </span></span>
<span><span class="co">#   group_by(color,word) %&gt;% </span></span>
<span><span class="co">#   anti_join(stop_words) %&gt;% </span></span>
<span><span class="co">#   filter(!is.na(word)) %&gt;% </span></span>
<span><span class="co">#   summarize(count=n()) %&gt;% </span></span>
<span><span class="co">#   arrange(desc(count), .by_group = TRUE)</span></span>
<span><span class="co">#   # count()</span></span>
<span></span>
<span><span class="va">word_tfidf</span> <span class="op">&lt;-</span> <span class="va">Txtdf</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># filter(!is.na(color)) %&gt;% </span></span>
<span>  <span class="fu">unnest_tokens</span><span class="op">(</span><span class="va">word</span>,<span class="va">flavor</span>, to_lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">color</span>,<span class="va">word</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">bind_tf_idf</span><span class="op">(</span><span class="va">word</span>,<span class="va">color</span>,<span class="va">n</span><span class="op">)</span></span>
<span>  <span class="co"># </span></span>
<span>  <span class="co"># mutate(total_flavor_words=sum(n)) %&gt;% </span></span>
<span>  <span class="co"># #dplyr::select(color,word) %&gt;% </span></span>
<span>  <span class="co"># group_by(color,word) %&gt;% </span></span>
<span>  <span class="co"># anti_join(stop_words) %&gt;% </span></span>
<span>  <span class="co"># filter(!is.na(word)) %&gt;% </span></span>
<span>  <span class="co"># summarize(</span></span>
<span>  <span class="co">#   # count=n(),</span></span>
<span>  <span class="co">#           rank=row_number(),</span></span>
<span>  <span class="co">#           term_frequency=n/total) %&gt;% </span></span>
<span>  <span class="co">#   ungroup()</span></span>
<span>  </span>
<span><span class="va">word_tfidf</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">color</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice_max</span><span class="op">(</span><span class="va">tf_idf</span>, n<span class="op">=</span><span class="fl">15</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">tf_idf</span>, <span class="fu">fct_reorder</span><span class="op">(</span><span class="va">word</span>, <span class="va">tf_idf</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">color</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">color</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"tf-idf"</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/create and graph tfidf-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/graph keyword count_f07c048d5044e954d08c2311d7108d9d">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"keyword_"</span><span class="op">)</span>, </span>
<span>              <span class="va">color_green</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">color_green</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span>.cols<span class="op">=</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"keyword"</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"keyword"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"keyword"</span>, values_to <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>keyword<span class="op">=</span><span class="fu">str_remove</span><span class="op">(</span><span class="va">keyword</span>,<span class="st">"keyword_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice_max</span><span class="op">(</span><span class="va">count</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="co"># ungroup() %&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="fu">fct_reorder</span><span class="op">(</span><span class="va">keyword</span>, <span class="va">count</span><span class="op">)</span>, <span class="va">count</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           fill <span class="op">=</span> <span class="st">"#7CCD7C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet_wrap(~color, ncol = 2, scales = "free") +</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"word count"</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/graph keyword count-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/code for wordcloud not currently in use_c92ac88adaefecc46c06e698b16aa9c1">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># library(ggwordcloud)</span></span>
<span><span class="co"># data("love_words_small")</span></span>
<span><span class="co"># set.seed(42)</span></span>
<span><span class="co"># word_tfidf %&gt;% </span></span>
<span><span class="co">#   # filter(color==green) %&gt;% </span></span>
<span><span class="co"># ggplot(love_words_small, aes(label = word, size = count)) +</span></span>
<span><span class="co">#   ggwordcloud::geom_text_wordcloud() +</span></span>
<span><span class="co">#   scale_size_area(max_size = 40) +</span></span>
<span><span class="co">#   theme_minimal()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="coocurrance" class="level1"><h1>Coocurrance</h1>
<div class="cell" data-hash="magicTheGathering_cache/html/red coocurrances_afdf5596414dfb043285fcf4f1a0621a">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">red_color_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># filter(multicolor==1) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">color_red</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    red_green_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_green</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    red_blue_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_blue</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    red_white_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_white</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    red_black_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_black</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="va">red_color_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      n red_green_occurance red_blue_occurance red_white_occurance
  &lt;int&gt; &lt;chr&gt;               &lt;chr&gt;              &lt;chr&gt;              
1  8062 7.45%               6.69%              5.99%              
# ℹ 1 more variable: red_black_occurance &lt;chr&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">red_green_occurance</span> <span class="op">&lt;-</span> <span class="va">red_color_df</span><span class="op">$</span><span class="va">red_green_occurance</span></span>
<span><span class="va">red_blue_occurance</span> <span class="op">&lt;-</span> <span class="va">red_color_df</span><span class="op">$</span><span class="va">red_blue_occurance</span></span>
<span><span class="va">red_white_occurance</span> <span class="op">&lt;-</span> <span class="va">red_color_df</span><span class="op">$</span><span class="va">red_white_occurance</span></span>
<span><span class="va">red_black_occurance</span> <span class="op">&lt;-</span> <span class="va">red_color_df</span><span class="op">$</span><span class="va">red_black_occurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/green coocurrances_6415d0cf9f24f29a2e788c17b7398c49">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">green_color_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># filter(multicolor==1) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">color_green</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    green_red_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_red</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    green_blue_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_blue</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    green_white_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_white</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    green_black_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_black</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="va">green_color_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      n green_red_occurance green_blue_occurance green_white_occurance
  &lt;int&gt; &lt;chr&gt;               &lt;chr&gt;                &lt;chr&gt;                
1  8244 7.29%               6.11%                7.1%                 
# ℹ 1 more variable: green_black_occurance &lt;chr&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">green_red_occurance</span> <span class="op">&lt;-</span> <span class="va">green_color_df</span><span class="op">$</span><span class="va">green_red_occurance</span></span>
<span><span class="va">green_blue_occurance</span> <span class="op">&lt;-</span> <span class="va">green_color_df</span><span class="op">$</span><span class="va">green_blue_occurance</span></span>
<span><span class="va">green_white_occurance</span> <span class="op">&lt;-</span> <span class="va">green_color_df</span><span class="op">$</span><span class="va">green_white_occurance</span></span>
<span><span class="va">green_black_occurance</span> <span class="op">&lt;-</span> <span class="va">green_color_df</span><span class="op">$</span><span class="va">green_black_occurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/blue coocurrances_5a1d91e272ac940c4c468e664f77c682">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">blue_color_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># filter(multicolor==1) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">color_blue</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    blue_red_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_red</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    blue_green_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_green</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    blue_white_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_white</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    blue_black_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_black</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">blue_color_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      n blue_red_occurance blue_green_occurance blue_white_occurance
  &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;                &lt;chr&gt;               
1  8054 6.69%              6.26%                7.71%               
# ℹ 1 more variable: blue_black_occurance &lt;chr&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">blue_red_occurance</span> <span class="op">&lt;-</span> <span class="va">blue_color_df</span><span class="op">$</span><span class="va">blue_red_occurance</span></span>
<span><span class="va">blue_green_occurance</span> <span class="op">&lt;-</span> <span class="va">blue_color_df</span><span class="op">$</span><span class="va">blue_green_occurance</span></span>
<span><span class="va">blue_white_occurance</span> <span class="op">&lt;-</span> <span class="va">blue_color_df</span><span class="op">$</span><span class="va">blue_white_occurance</span></span>
<span><span class="va">blue_black_occurance</span> <span class="op">&lt;-</span> <span class="va">blue_color_df</span><span class="op">$</span><span class="va">blue_black_occurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/white coocurrances_3c08a62f524f2a99b22dde41ebe9581a">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">white_color_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># filter(multicolor==1) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">color_white</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    white_red_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_red</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    white_blue_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_blue</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    white_green_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_green</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    white_black_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_black</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">white_color_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      n white_red_occurance white_blue_occurance white_green_occurance
  &lt;int&gt; &lt;chr&gt;               &lt;chr&gt;                &lt;chr&gt;                
1  8152 5.92%               7.62%                7.18%                
# ℹ 1 more variable: white_black_occurance &lt;chr&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">white_red_occurance</span> <span class="op">&lt;-</span> <span class="va">white_color_df</span><span class="op">$</span><span class="va">white_red_occurance</span></span>
<span><span class="va">white_blue_occurance</span> <span class="op">&lt;-</span> <span class="va">white_color_df</span><span class="op">$</span><span class="va">white_blue_occurance</span></span>
<span><span class="va">white_green_occurance</span> <span class="op">&lt;-</span> <span class="va">white_color_df</span><span class="op">$</span><span class="va">white_green_occurance</span></span>
<span><span class="va">white_black_occurance</span> <span class="op">&lt;-</span> <span class="va">white_color_df</span><span class="op">$</span><span class="va">white_black_occurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/black coocurrances_232dcc9dd473c66280f666ea3b708eaa">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">black_color_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># filter(multicolor==1) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">color_black</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    black_red_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_red</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    black_blue_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_blue</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    black_white_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_white</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    black_green_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_green</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">black_color_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      n black_red_occurance black_blue_occurance black_white_occurance
  &lt;int&gt; &lt;chr&gt;               &lt;chr&gt;                &lt;chr&gt;                
1  8120 7.92%               7.94%                6.48%                
# ℹ 1 more variable: black_green_occurance &lt;chr&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">black_red_occurance</span> <span class="op">&lt;-</span> <span class="va">black_color_df</span><span class="op">$</span><span class="va">black_red_occurance</span></span>
<span><span class="va">black_blue_occurance</span> <span class="op">&lt;-</span> <span class="va">black_color_df</span><span class="op">$</span><span class="va">black_blue_occurance</span></span>
<span><span class="va">black_white_occurance</span> <span class="op">&lt;-</span> <span class="va">black_color_df</span><span class="op">$</span><span class="va">black_white_occurance</span></span>
<span><span class="va">black_green_occurance</span> <span class="op">&lt;-</span> <span class="va">black_color_df</span><span class="op">$</span><span class="va">black_green_occurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/colorless coocurrances_c952f4627d9c3f803175b57f50631e5c">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colorless_color_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># filter(multicolor==1) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">color_colorless</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    colorless_red_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_red</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    colorless_green_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_green</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    colorless_blue_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_blue</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    colorless_white_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_white</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>    colorless_black_occurance<span class="op">=</span><span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">color_black</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span> <span class="op">*</span><span class="fl">100</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="va">colorless_color_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
      n colorless_red_occurance colorless_green_occurance colorless_blue_occur…¹
  &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt;                     &lt;chr&gt;                 
1 40902 19.69%                  20.15%                    19.68%                
# ℹ abbreviated name: ¹​colorless_blue_occurance
# ℹ 2 more variables: colorless_white_occurance &lt;chr&gt;,
#   colorless_black_occurance &lt;chr&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colorless_red_occurance</span> <span class="op">&lt;-</span> <span class="va">colorless_color_df</span><span class="op">$</span><span class="va">colorless_red_occurance</span></span>
<span><span class="va">colorless_green_occurance</span> <span class="op">&lt;-</span> <span class="va">colorless_color_df</span><span class="op">$</span><span class="va">colorless_green_occurance</span></span>
<span><span class="va">colorless_blue_occurance</span> <span class="op">&lt;-</span> <span class="va">colorless_color_df</span><span class="op">$</span><span class="va">colorless_blue_occurance</span></span>
<span><span class="va">colorless_white_occurance</span> <span class="op">&lt;-</span> <span class="va">colorless_color_df</span><span class="op">$</span><span class="va">colorless_white_occurance</span></span>
<span><span class="va">colorless_black_occurance</span> <span class="op">&lt;-</span> <span class="va">colorless_color_df</span><span class="op">$</span><span class="va">colorless_black_occurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="machine-learning" class="level1"><h1>Machine Learning</h1>
<div class="cell" data-hash="magicTheGathering_cache/html/graphing converted mana cost_c57480d7da0baf99b1e38c37bce6217b">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>converted_mana_cost<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">converted_mana_cost</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">tab</span><span class="op">(</span><span class="va">converted_mana_cost</span>,plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/graphing converted mana cost-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Regression</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Classification by quantile</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Classification collapsing medium category</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-hash="magicTheGathering_cache/html/model v1 regression modeling_925b446a85689081bbce4b0e99fbbb43">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modeling_type</span> <span class="op">&lt;-</span> <span class="st">"regression"</span></span>
<span><span class="va">prioritized_metric</span> <span class="op">&lt;-</span> <span class="st">"rmse"</span></span>
<span><span class="co"># strat_by_devar &lt;- TRUE</span></span>
<span><span class="va">devar</span> <span class="op">&lt;-</span> <span class="st">"converted_mana_cost"</span></span>
<span><span class="va">invars</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>  <span class="co"># starts_with("keyword_"),</span></span>
<span>  <span class="co"># sorcery,instant,battle,planeswalker,enchantment,artifact,land,creature,</span></span>
<span>  <span class="va">variable_power</span>,<span class="va">variable_toughness</span>,<span class="va">power</span>,<span class="va">toughness</span>, </span>
<span>  <span class="va">multicolor</span>,</span>
<span>  <span class="va">number_of_keywords</span>,</span>
<span>  <span class="fu">starts_with</span><span class="op">(</span><span class="st">"color"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">colors</span>,</span>
<span>         <span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"color_identity"</span><span class="op">)</span>,</span>
<span>                      <span class="op">-</span><span class="va">colorless_cost</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modeldf</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="co"># color_green==1, </span></span>
<span>                         <span class="co"># land != 1, </span></span>
<span>        <span class="op">(</span> <span class="va">creature</span><span class="op">==</span><span class="fl">1</span> <span class="op">|</span> <span class="va">artifact</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">all_of</span><span class="op">(</span><span class="va">invars</span><span class="op">)</span>,<span class="va">devar</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># mutate(converted_mana_cost=as.factor(ifelse(converted_mana_cost &lt;=5,as.character(converted_mana_cost), "5+" ))</span></span>
<span>           <span class="co"># ) %&gt;% </span></span>
<span>  <span class="co"># mutate(mana_cost_q=as.factor(mana_cost_q)) %&gt;% </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(devar)

  # Now:
  data %&gt;% select(all_of(devar))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Scripts"</span>,<span class="st">"tidyModelsGeneralModeling.R"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(invars)

  # Now:
  data %&gt;% select(all_of(invars))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 1 of 6 tuning:     boosting</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 1 of 6 tuning:     boosting (5m 13.5s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 2 of 6 tuning:     SVM_radial</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 2 of 6 tuning:     SVM_radial (5m 52.3s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 3 of 6 tuning:     KNN</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 3 of 6 tuning:     KNN (6m 41.1s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 4 of 6 tuning:     neural_network</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 4 of 6 tuning:     neural_network (1m 29s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 5 of 6 resampling: full_quad_linear_reg</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: prediction from a rank-deficient fit may be misleading</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 5 of 6 resampling: full_quad_linear_reg (3.2s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 6 of 6 tuning:     full_quad_KNN</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 6 of 6 tuning:     full_quad_KNN (22m 22.3s)</code></pre>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/assigning results from model 1_e65321bcd3ca54774607e0f737403b3a">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">autoplot</span><span class="op">(</span></span>
<span>  <span class="va">grid_results</span>,</span>
<span>  rank_metric <span class="op">=</span> <span class="va">prioritized_metric</span>,  <span class="co"># &lt;- how to order models</span></span>
<span>  metric <span class="op">=</span> <span class="va">prioritized_metric</span>,       <span class="co"># &lt;- which metric to visualize</span></span>
<span>  select_best <span class="op">=</span> <span class="cn">TRUE</span>     <span class="co"># &lt;- one point per workflow</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/assigning results from model 1-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_init_model_v1</span> <span class="op">&lt;-</span> <span class="va">best_init_model</span></span>
<span></span>
<span><span class="va">best_results_v1</span> <span class="op">&lt;-</span> <span class="va">best_results</span></span>
<span></span>
<span><span class="va">finalized_best_init_model_v1</span> <span class="op">&lt;-</span> <span class="va">finalized_best_init_model</span></span>
<span></span>
<span><span class="va">best_init_model_explainer_v1</span> <span class="op">&lt;-</span> <span class="va">best_init_model_explainer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/model 1 checking resids_7862884f58693aa68dd866c6c6876f0a">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">finalized_best_init_model_v1</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span> <span class="va">converted_mana_cost</span>, y<span class="op">=</span><span class="va">.pred</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu">geom_abline</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray50"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">coord_obs_pred</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"observed"</span>, y <span class="op">=</span> <span class="st">"predicted"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/model 1 checking resids-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># performance::check_model()</span></span>
<span><span class="va">finalized_best_init_model_v1</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>.resids<span class="op">=</span><span class="va">converted_mana_cost</span> <span class="op">-</span> <span class="va">.pred</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">.resids</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>fill<span class="op">=</span><span class="st">'cornflowerblue'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/model 1 checking resids-2.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">finalized_best_init_model_v1</span> <span class="op">%&gt;%</span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard       0.582 Preprocessor1_Model1
2 rsq     standard       0.656 Preprocessor1_Model1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_init_model_v1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "KNN"</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-hash="magicTheGathering_cache/html/model v2 classification modeling_eec177c628934b575c7918778c243fb4">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modeling_type</span> <span class="op">&lt;-</span> <span class="st">"classification"</span></span>
<span><span class="va">prioritized_metric</span> <span class="op">&lt;-</span> <span class="st">"precision"</span></span>
<span><span class="co"># strat_by_devar &lt;- TRUE</span></span>
<span><span class="va">devar</span> <span class="op">&lt;-</span> <span class="st">"mana_cost_q"</span></span>
<span><span class="va">invars</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>  <span class="co"># starts_with("keyword_"),</span></span>
<span>  <span class="co"># sorcery,instant,battle,planeswalker,enchantment,artifact,land,creature,</span></span>
<span>  <span class="va">variable_power</span>,<span class="va">variable_toughness</span>,<span class="va">power</span>,<span class="va">toughness</span>, </span>
<span>  <span class="va">multicolor</span>,</span>
<span>  <span class="va">number_of_keywords</span>,</span>
<span>  <span class="fu">starts_with</span><span class="op">(</span><span class="st">"color"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">colors</span>,</span>
<span>         <span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"color_identity"</span><span class="op">)</span>,</span>
<span>                      <span class="op">-</span><span class="va">colorless_cost</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modeldf</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="co"># color_green==1, </span></span>
<span>                         <span class="co"># land != 1, </span></span>
<span>        <span class="op">(</span> <span class="va">creature</span><span class="op">==</span><span class="fl">1</span> <span class="op">|</span> <span class="va">artifact</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">all_of</span><span class="op">(</span><span class="va">invars</span><span class="op">)</span>,<span class="va">devar</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># mutate(converted_mana_cost=as.factor(ifelse(converted_mana_cost &lt;=5,as.character(converted_mana_cost), "5+" ))</span></span>
<span>           <span class="co"># ) %&gt;% </span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mana_cost_q<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mana_cost_q</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Scripts"</span>,<span class="st">"tidyModelsGeneralModeling.R"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 1 of 8 resampling: decisionTree</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 399</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ B | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 427</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1
→ C | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 422
There were issues with some computations   A: x1
→ D | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 426
There were issues with some computations   A: x1
→ E | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 441
There were issues with some computations   A: x1
→ F | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 373
There were issues with some computations   A: x1
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x…
→ G | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 395
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x…
→ H | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 417
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x…
→ I | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 383
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x…
→ J | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
                Precision is undefined in this case, and those levels will be removed from the averaged result.
                Note that the following number of true events actually occured for each problematic event level:
                'medium-high cost': 379
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x…
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x…

✔ 1 of 8 resampling: decisionTree (4.1s)
i   No tuning parameters. `fit_resamples()` will be attempted
i 2 of 8 resampling: SLNN
✔ 2 of 8 resampling: SLNN (13.6s)
i 3 of 8 tuning:     randomforest
✔ 3 of 8 tuning:     randomforest (2m 50.4s)
i   No tuning parameters. `fit_resamples()` will be attempted
i 4 of 8 resampling: multinomialnnet
✔ 4 of 8 resampling: multinomialnnet (5.5s)
i 5 of 8 tuning:     multinomialglmnet
✔ 5 of 8 tuning:     multinomialglmnet (23s)
i   No tuning parameters. `fit_resamples()` will be attempted
i 6 of 8 resampling: LDA
→ A | warning: variables are collinear
There were issues with some computations   A: x1
There were issues with some computations   A: x10

✔ 6 of 8 resampling: LDA (1.4s)
i   No tuning parameters. `fit_resamples()` will be attempted
i 7 of 8 resampling: NaiveBayes_rec
→ A | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 427
There were issues with some computations   A: x1
→ B | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 422
There were issues with some computations   A: x1
→ C | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 426
There were issues with some computations   A: x1
There were issues with some computations   A: x1   B: x1   C: x1
→ D | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 395
There were issues with some computations   A: x1   B: x1   C: x1
There were issues with some computations   A: x1   B: x1   C: x1   D: x1
→ E | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'medium-high cost': 383
There were issues with some computations   A: x1   B: x1   C: x1   D: x1
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x1
There were issues with some computations   A: x1   B: x1   C: x1   D: x1   E: x1

✔ 7 of 8 resampling: NaiveBayes_rec (19s)
i   No tuning parameters. `fit_resamples()` will be attempted
i 8 of 8 resampling: linearSVM
✔ 8 of 8 resampling: linearSVM (1m 29.2s)
→ A | warning: variables are collinear
There were issues with some computations   A: x1
There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in lda.default(x, grouping, ...): variables are collinear</code></pre>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/assigning results from model 2_819f3b89648b003075799249e7467a49">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">autoplot</span><span class="op">(</span></span>
<span>  <span class="va">grid_results</span>,</span>
<span>  rank_metric <span class="op">=</span> <span class="va">prioritized_metric</span>,  <span class="co"># &lt;- how to order models</span></span>
<span>  metric <span class="op">=</span> <span class="va">prioritized_metric</span>,       <span class="co"># &lt;- which metric to visualize</span></span>
<span>  select_best <span class="op">=</span> <span class="cn">TRUE</span>     <span class="co"># &lt;- one point per workflow</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/assigning results from model 2-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_init_model_v2</span> <span class="op">&lt;-</span> <span class="va">best_init_model</span></span>
<span></span>
<span><span class="va">best_results_v2</span> <span class="op">&lt;-</span> <span class="va">best_results</span></span>
<span></span>
<span><span class="va">finalized_best_init_model_v2</span> <span class="op">&lt;-</span> <span class="va">finalized_best_init_model</span></span>
<span></span>
<span><span class="va">best_init_model_explainer_v2</span> <span class="op">&lt;-</span> <span class="va">best_init_model_explainer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/model 2 checking results_4fa07bc7d1f9285ee0dc97da8b96633c">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">finalized_best_init_model_v2</span> <span class="op">%&gt;%</span> <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># group_by(Resample) %&gt;% </span></span>
<span>  <span class="fu">roc_curve</span><span class="op">(</span><span class="va">mana_cost_q</span>, <span class="va">`.pred_high cost`</span>, <span class="va">`.pred_low cost`</span>,<span class="va">`.pred_medium-high cost`</span>, <span class="va">`.pred_medium-low cost`</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/model 2 checking results-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">conf_mat_resampled</span><span class="op">(</span><span class="va">finalized_best_init_model_v2</span>, tidy<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="va">cm</span>, type<span class="op">=</span><span class="st">"heatmap"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/model 2 checking results-2.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># aes(fill = rep(colnames(cm$table), ncol(cm$table))) + labs(fill = "Predicted")</span></span>
<span><span class="fu">conf_mat_resampled</span><span class="op">(</span><span class="va">finalized_best_init_model_v2</span>, tidy<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">.metric</span><span class="op">==</span><span class="st">"accuracy"</span> <span class="op">|</span> <span class="va">.metric</span><span class="op">==</span><span class="st">"precision"</span> <span class="op">|</span> <span class="va">.metric</span><span class="op">==</span><span class="st">"recall"</span> <span class="op">|</span> <span class="va">.metric</span><span class="op">==</span><span class="st">"f_meas"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>.metric<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">.metric</span><span class="op">==</span><span class="st">"f_meas"</span>, <span class="st">"f1 score"</span>, <span class="va">.metric</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">.metric</th>
<th style="text-align: left;">.estimator</th>
<th style="text-align: right;">.estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.5205291</td>
</tr>
<tr class="even">
<td style="text-align: left;">precision</td>
<td style="text-align: left;">macro</td>
<td style="text-align: right;">0.4701008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">recall</td>
<td style="text-align: left;">macro</td>
<td style="text-align: right;">0.4607179</td>
</tr>
<tr class="even">
<td style="text-align: left;">f1 score</td>
<td style="text-align: left;">macro</td>
<td style="text-align: right;">0.4270918</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">finalized_best_init_model_v2</span> <span class="op">%&gt;%</span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass     0.521 Preprocessor1_Model1
2 roc_auc  hand_till      0.766 Preprocessor1_Model1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_init_model_v2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "LDA"</code></pre>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/model 2 base model accuracy_2e51c912d699672929853eeea26cafbd">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">basemodel_q_acc</span> <span class="op">&lt;-</span> <span class="va">modeldf</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">mana_cost_q</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>totaln<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">mana_cost_q</span>,<span class="va">totaln</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>base_model_acc<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="va">totaln</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">base_model_acc</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">slice_max</span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">base_model_acc</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'mana_cost_q'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-hash="magicTheGathering_cache/html/model v3 classification modeling_edef2f62245c7b3c0dca166d40f999b0">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modeling_type</span> <span class="op">&lt;-</span> <span class="st">"classification"</span></span>
<span><span class="va">prioritized_metric</span> <span class="op">&lt;-</span> <span class="st">"precision"</span></span>
<span><span class="co"># strat_by_devar &lt;- TRUE</span></span>
<span><span class="va">devar</span> <span class="op">&lt;-</span> <span class="st">"mana_cost_q"</span></span>
<span><span class="va">invars</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>  <span class="co"># starts_with("keyword_"),</span></span>
<span>  <span class="co"># sorcery,instant,battle,planeswalker,enchantment,artifact,land,creature,</span></span>
<span>  <span class="va">variable_power</span>,<span class="va">variable_toughness</span>,<span class="va">power</span>,<span class="va">toughness</span>, </span>
<span>  <span class="va">multicolor</span>,</span>
<span>  <span class="va">number_of_keywords</span>,</span>
<span>  <span class="fu">starts_with</span><span class="op">(</span><span class="st">"color"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">colors</span>,</span>
<span>         <span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"color_identity"</span><span class="op">)</span>,</span>
<span>                      <span class="op">-</span><span class="va">colorless_cost</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modeldf</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="co"># color_green==1, </span></span>
<span>                         <span class="co"># land != 1, </span></span>
<span>        <span class="op">(</span> <span class="va">creature</span><span class="op">==</span><span class="fl">1</span> <span class="op">|</span> <span class="va">artifact</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">all_of</span><span class="op">(</span><span class="va">invars</span><span class="op">)</span>,<span class="va">devar</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># mutate(converted_mana_cost=as.factor(ifelse(converted_mana_cost &lt;=5,as.character(converted_mana_cost), "5+" ))</span></span>
<span>           <span class="co"># ) %&gt;% </span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mana_cost_t<span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">mana_cost_q</span><span class="op">==</span><span class="st">"high cost"</span> <span class="op">~</span><span class="op">(</span><span class="va">mana_cost_q</span><span class="op">)</span>,</span>
<span>    <span class="va">mana_cost_q</span><span class="op">==</span><span class="st">"medium-high cost"</span> <span class="op">~</span><span class="op">(</span><span class="st">"medium cost"</span><span class="op">)</span>,</span>
<span>    <span class="va">mana_cost_q</span><span class="op">==</span><span class="st">"medium-low cost"</span> <span class="op">~</span><span class="op">(</span><span class="st">"medium cost"</span><span class="op">)</span>,</span>
<span>    <span class="va">mana_cost_q</span><span class="op">==</span><span class="st">"low cost"</span> <span class="op">~</span><span class="op">(</span><span class="va">mana_cost_q</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  mana_cost_t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mana_cost_t</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">devar</span> <span class="op">&lt;-</span> <span class="st">"mana_cost_t"</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Scripts"</span>,<span class="st">"tidyModelsGeneralModeling.R"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 1 of 8 resampling: decisionTree</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 1 of 8 resampling: decisionTree (3.9s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 2 of 8 resampling: SLNN</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 2 of 8 resampling: SLNN (11.7s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 3 of 8 tuning:     randomforest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 3 of 8 tuning:     randomforest (7m 42.9s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 4 of 8 resampling: multinomialnnet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 4 of 8 resampling: multinomialnnet (3.2s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 5 of 8 tuning:     multinomialglmnet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 5 of 8 tuning:     multinomialglmnet (17.9s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 6 of 8 resampling: LDA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: variables are collinear</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 6 of 8 resampling: LDA (1.2s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 7 of 8 resampling: NaiveBayes_rec</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 7 of 8 resampling: NaiveBayes_rec (19.4s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i   No tuning parameters. `fit_resamples()` will be attempted</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>i 8 of 8 resampling: linearSVM</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: While computing multiclass `precision()`, some levels had no predicted events (i.e. `true_positive + false_positive = 0`). 
               Precision is undefined in this case, and those levels will be removed from the averaged result.
               Note that the following number of true events actually occured for each problematic event level:
               'low cost': 283</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1
There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 8 of 8 resampling: linearSVM (1m 10.9s)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: variables are collinear</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1
There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in lda.default(x, grouping, ...): variables are collinear</code></pre>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/assigning results from model 3_5d0309bb0eaba2436cae5ea7f8b48b59">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">autoplot</span><span class="op">(</span></span>
<span>  <span class="va">grid_results</span>,</span>
<span>  rank_metric <span class="op">=</span> <span class="va">prioritized_metric</span>,  <span class="co"># &lt;- how to order models</span></span>
<span>  metric <span class="op">=</span> <span class="va">prioritized_metric</span>,       <span class="co"># &lt;- which metric to visualize</span></span>
<span>  select_best <span class="op">=</span> <span class="cn">TRUE</span>     <span class="co"># &lt;- one point per workflow</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/assigning results from model 3-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_init_model_v3</span> <span class="op">&lt;-</span> <span class="va">best_init_model</span></span>
<span></span>
<span><span class="va">best_results_v3</span> <span class="op">&lt;-</span> <span class="va">best_results</span></span>
<span></span>
<span><span class="va">finalized_best_init_model_v3</span> <span class="op">&lt;-</span> <span class="va">finalized_best_init_model</span></span>
<span></span>
<span><span class="va">best_init_model_explainer_v3</span> <span class="op">&lt;-</span> <span class="va">best_init_model_explainer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/model 3 checking results_064ae7eccad115ae074f2d323c1d7752">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">finalized_best_init_model_v3</span> <span class="op">%&gt;%</span> <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># group_by(Resample) %&gt;% </span></span>
<span>  <span class="fu">roc_curve</span><span class="op">(</span><span class="va">mana_cost_t</span>, <span class="va">`.pred_high cost`</span>, <span class="va">`.pred_low cost`</span>,<span class="va">`.pred_medium cost`</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/model 3 checking results-1.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">conf_mat_resampled</span><span class="op">(</span><span class="va">finalized_best_init_model_v3</span>, tidy<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="va">cm</span>, type<span class="op">=</span><span class="st">"heatmap"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/model 3 checking results-2.png" class="img-fluid" width="672"></p>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># aes(fill = rep(colnames(cm$table), ncol(cm$table))) + labs(fill = "Predicted")</span></span>
<span><span class="fu">conf_mat_resampled</span><span class="op">(</span><span class="va">finalized_best_init_model_v3</span>, tidy<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">.metric</span><span class="op">==</span><span class="st">"accuracy"</span> <span class="op">|</span> <span class="va">.metric</span><span class="op">==</span><span class="st">"precision"</span> <span class="op">|</span> <span class="va">.metric</span><span class="op">==</span><span class="st">"recall"</span> <span class="op">|</span> <span class="va">.metric</span><span class="op">==</span><span class="st">"f_meas"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>.metric<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">.metric</span><span class="op">==</span><span class="st">"f_meas"</span>, <span class="st">"f1 score"</span>, <span class="va">.metric</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">.metric</th>
<th style="text-align: left;">.estimator</th>
<th style="text-align: right;">.estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">multiclass</td>
<td style="text-align: right;">0.6507473</td>
</tr>
<tr class="even">
<td style="text-align: left;">precision</td>
<td style="text-align: left;">macro</td>
<td style="text-align: right;">0.5373280</td>
</tr>
<tr class="odd">
<td style="text-align: left;">recall</td>
<td style="text-align: left;">macro</td>
<td style="text-align: right;">0.5163470</td>
</tr>
<tr class="even">
<td style="text-align: left;">f1 score</td>
<td style="text-align: left;">macro</td>
<td style="text-align: right;">0.4863668</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">finalized_best_init_model_v3</span> <span class="op">%&gt;%</span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass     0.651 Preprocessor1_Model1
2 roc_auc  hand_till      0.808 Preprocessor1_Model1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_init_model_v3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "LDA"</code></pre>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/model 3 base model accuracy_e08dbfa88464ee95a69ce277dc7beb2d">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">basemodel_t_acc</span> <span class="op">&lt;-</span> <span class="va">modeldf</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">mana_cost_t</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>totaln<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">mana_cost_t</span>,<span class="va">totaln</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>base_model_acc<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="va">totaln</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">base_model_acc</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">slice_max</span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">base_model_acc</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'mana_cost_t'. You can override using the
`.groups` argument.</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">basemodel_t_acc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4967786</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/compare models_a4996d96e4dece70beb48914b729a5ca">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Eventually I want to replace this with AIC, but until I figure out where my code is going wrong this'll have to do</span></span>
<span><span class="va">finalized_best_init_model_v1</span> <span class="op">%&gt;%</span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard       0.582 Preprocessor1_Model1
2 rsq     standard       0.656 Preprocessor1_Model1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">finalized_best_init_model_v2</span> <span class="op">%&gt;%</span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass     0.521 Preprocessor1_Model1
2 roc_auc  hand_till      0.766 Preprocessor1_Model1</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">finalized_best_init_model_v3</span> <span class="op">%&gt;%</span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy multiclass     0.651 Preprocessor1_Model1
2 roc_auc  hand_till      0.808 Preprocessor1_Model1</code></pre>
</div>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/final model explainer_bfa54667da531e59c6cb12391b7e271c">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># source(here::here("Scripts", "functions.R"))</span></span>
<span><span class="va">explainer_best_fit_v3</span> <span class="op">&lt;-</span> <span class="fu">DALEXtra</span><span class="fu">::</span><span class="fu"><a href="https://ModelOriented.github.io/DALEXtra/reference/explain_tidymodels.html">explain_tidymodels</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="va">best_init_model_explainer_v3</span>,</span>
<span>    data<span class="op">=</span><span class="op">(</span><span class="va">df_train</span> <span class="op">%&gt;%</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">devar</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># y=paste("df_train$",devar, sep=""),</span></span>
<span>    y<span class="op">=</span><span class="va">df_train</span><span class="op">$</span><span class="va">mana_cost_t</span></span>
<span>    <span class="co"># label="best initial model"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Preparation of a new explainer is initiated
  -&gt; model label       :  workflow  (  default  )
  -&gt; data              :  17461  rows  13  cols 
  -&gt; data              :  tibble converted into a data.frame 
  -&gt; target variable   :  17461  values 
  -&gt; predict function  :  yhat.workflow  will be used (  default  )
  -&gt; predicted values  :  No value for predict function target column. (  default  )
  -&gt; model_info        :  package tidymodels , ver. 1.1.0 , task multiclass (  default  ) 
  -&gt; predicted values  :  predict function returns multiple columns:  3  (  default  ) 
  -&gt; residual function :  difference between 1 and probability of true class (  default  )
  -&gt; residuals         :  numerical, min =  2.436755e-06 , mean =  0.4650833 , max =  0.9999992  
  A new explainer has been created!  </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1552</span><span class="op">)</span></span>
<span><span class="va">global_explainer_v3</span> <span class="op">&lt;-</span> <span class="fu">model_parts</span><span class="op">(</span><span class="va">explainer_best_fit_v3</span>, loss_reduction<span class="op">=</span> <span class="va">loss_root_mean_square</span><span class="op">)</span></span>
<span><span class="fu">ggplot_imp</span><span class="op">(</span><span class="va">global_explainer_v3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="magicTheGathering_files/figure-html/final model explainer-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="saving-data-for-reuse" class="level1"><h1>Saving Data for reuse</h1>
<div class="cell" data-hash="magicTheGathering_cache/html/assign final model vars for reuse_e42f714468b9b3aebf4c8141d2d4697f">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final_model</span> <span class="op">&lt;-</span> <span class="va">finalized_best_init_model_v3</span></span>
<span></span>
<span><span class="va">finalized_best_init_model</span> <span class="op">&lt;-</span> <span class="va">finalized_best_init_model_v3</span></span>
<span><span class="va">final_model_base_acc</span> <span class="op">&lt;-</span> <span class="va">basemodel_t_acc</span></span>
<span><span class="va">global_explainer_fin</span> <span class="op">&lt;-</span> <span class="va">global_explainer_v3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/pull final model accuracy_779667a5dce9b4bb76a5965adef72bd9">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final_model_acc</span> <span class="op">&lt;-</span> <span class="va">final_model</span> <span class="op">%&gt;%</span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">.metric</span><span class="op">==</span><span class="st">"accuracy"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.estimate</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">final_model_acc_str</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">final_model_acc</span><span class="op">)</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span></span>
<span><span class="va">final_model_improvement</span> <span class="op">&lt;-</span> <span class="va">final_model_acc</span> <span class="op">-</span><span class="va">final_model_base_acc</span></span>
<span><span class="va">final_model_improvement_str</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">final_model_improvement</span><span class="op">)</span> <span class="op">*</span><span class="fl">100</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="st">"%"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="magicTheGathering_cache/html/save vars for reuse in dashboard_7f8f3ca646a27369b0cbd4ad6643d1e5">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">datasave</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"finalized_best_init_model"</span>,</span>
<span>              <span class="st">"final_model_acc_str"</span>,</span>
<span>              <span class="st">"final_model_improvement_str"</span>,</span>
<span>              <span class="st">"df"</span>,</span>
<span>              <span class="st">"Txtdf"</span>,</span>
<span>              <span class="st">"ColorlessTxtdf"</span>,</span>
<span>              <span class="st">"keywords"</span>,</span>
<span>              <span class="st">"global_explainer_fin"</span>,</span>
<span>              <span class="st">"red_green_occurance"</span>,</span>
<span>              <span class="st">"red_blue_occurance"</span>,</span>
<span>              <span class="st">"red_white_occurance"</span>,</span>
<span>              <span class="st">"red_black_occurance"</span>,</span>
<span>              <span class="st">"green_red_occurance"</span>, </span>
<span>              <span class="st">"green_blue_occurance"</span>,</span>
<span>              <span class="st">"green_white_occurance"</span>,</span>
<span>              <span class="st">"green_black_occurance"</span>,</span>
<span>              <span class="st">"blue_red_occurance"</span>,</span>
<span>              <span class="st">"blue_green_occurance"</span>,</span>
<span>              <span class="st">"blue_white_occurance"</span>,</span>
<span>              <span class="st">"blue_black_occurance"</span>,</span>
<span>              <span class="st">"white_red_occurance"</span>,</span>
<span>              <span class="st">"white_blue_occurance"</span>,</span>
<span>              <span class="st">"white_green_occurance"</span>,</span>
<span>              <span class="st">"white_black_occurance"</span>,</span>
<span>              <span class="st">"black_red_occurance"</span>,</span>
<span>              <span class="st">"black_blue_occurance"</span>,</span>
<span>              <span class="st">"black_white_occurance"</span>,</span>
<span>              <span class="st">"black_green_occurance"</span>,</span>
<span>              <span class="st">"colorless_red_occurance"</span>,</span>
<span>              <span class="st">"colorless_blue_occurance"</span>,</span>
<span>              <span class="st">"colorless_green_occurance"</span>,</span>
<span>              <span class="st">"colorless_white_occurance"</span>,</span>
<span>              <span class="st">"colorless_black_occurance"</span></span>
<span>              <span class="op">)</span>, </span>
<span>       file<span class="op">=</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"Data"</span>,<span class="st">"Cleaned"</span>,<span class="st">"MTGDashData.RDA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">fortune</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="end" class="level1"><h1>End</h1>
<p>sources: all data except keywords from https://docs.magicthegathering.io/ using the python SDK v 1.3.1 (https://github.com/MagicTheGathering/mtg-sdk-python) keywords data from https://scryfall.com/docs/api</p>


</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>